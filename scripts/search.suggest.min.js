function fetchSuggestions(e){if(e==undefined||!inArray(e,new Array(13,16,20,27,37,38,39,40))&&!isCtrl&&!isCmd){if($("#i").val()!=""&&eng[current.engine].places[current.place][1]!==false){current.suggestionsTimestamp=(new Date).getTime();var t=eng[current.engine].places[current.place][1];t=t.replace("%query%",encodeURIComponent($("#i").val()));t=t.replace("%time%",current.suggestionsTimestamp);if(typeof eng[current.engine].languages=="object")t=t.replace("%lang%",eng[current.engine].languages[current.language]);$.getJSON(t,function(e){buildSuggestions(e)})}else closeSugBox(false)}}function buildSuggestions(e){if(e.empty){if(console)console.log("(1) Suggestions for '"+e.query+"' empty.");closeSugBox(false)}else if(e.engine==current.engine&&e.timestamp==current.suggestionsTimestamp&&e.query==$("#i").val()){if(console)console.log("(2) Suggestions for '"+e.query+"' accepted.");$("#sugs").html("");for(sug in e.results){sug=e.results[sug];$("#sugs").append("<li><a href='"+sug[1]+"'>"+sug[0]+"</a></li>")}$("#sugs").css({display:"block"});$("#sugs li").mousemove(function(){$("#sugs .active").removeClass("active");$(this).addClass("active")}).click(function(){applySugResult()})}else{if(console)console.log("(3) Suggestions for '"+e.query+"' discarded.")}}function prevSugResult(){if($("#sugs").css("display")=="none")return;if($("#sugs .active").length==0){$("#sugs li:last-child").addClass("active")}else{$("#sugs .active").removeClass("active").prev().addClass("active")}backupQuery()}function nextSugResult(){if($("#sugs").css("display")=="none")return;if($("#sugs .active").length==0){$("#sugs li:first-child").addClass("active")}else{$("#sugs .active").removeClass("active").next().addClass("active")}backupQuery()}function backupQuery(){if($("#sugs .active").length>0){if(!originalQuery)originalQuery=$("#i").val();$("#i").val($("#sugs .active a").html())}else{$("#i").val(originalQuery);originalQuery=false}}function closeSugBox(e){if(e==false||e==undefined||e.id!="i"&&e.id!="sugs")$("#sugs").html("").css({display:"none"})}function applySugResult(){if($("#sugs .active").length>0){$("#i").val($("#sugs .active a").html());closeSugBox(false)}}var originalQuery=false